

```{r}
library(Seurat)
library(ggplot2)
library(dplyr)
library(Seurat)
library(tidyseurat)

seurat_object <- tar_read(seurat_object_lognorm_annotated)
seurat_object <- load_seurat(seurat_object)

# Filter the Seurat object metadata for Ductal and MUC5B+ Ductal cells
filtered_cells <- seurat_object %>%
    subset(cell_type %in% c("Ductal", "MUC5B+ Ductal")) |>
    dplyr::filter(ku_ductal_UCell > 1)

# Extract the ku_ductal scores for these cells
ku_ductal_scores <- filtered_cells@meta.data %>%
    select(cell_type, ku_ductal = ku_ductal_UCell)

# Create the density plot using ggplot2
density_plot <- ggplot(ku_ductal_scores, aes(x = ku_ductal, fill = cell_type)) +
    geom_density(alpha = 0.5) +
    theme_minimal() +
    labs(
        title = "Density Plot of ku_ductal Scores for Ductal and MUC5B+ Ductal Cells",
        x = "ku_ductal Score",
        y = "Density"
    ) +
    scale_fill_manual(values = c("Ductal" = "blue", "MUC5B+ Ductal" = "red"))

# Print the density plot
print(density_plot)
#
#
#```
